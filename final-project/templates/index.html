{% extends 'layout.html' %}

{% block title %}My Plants{% endblock %}

{% block content %}
<h2>My Registered Plants</h2>

{% if plants %}
<div class="plant-grid-container">

    {% for plant in plants %}
    <div class="plant-card">

        {% if plant['image_url'] %}
        <img src="{{ url_for('static', filename=plant['image_url']) }}" alt="{{ plant['name'] }}"
            class="plant-card-img">
        {% else %}
        <div class="plant-card-img-placeholder">
            <span>No Image</span>
        </div>
        {% endif %}

        <div class="plant-card-body">
            <h3>{{ plant['name'] }}</h3>
            <p><em>Species: {{ plant['species'] }}</em></p>

            <span class="plant-date">
                Last Watered: {{ plant['last_watered'].strftime('%b %d, %Y at %I:%M %p') }}
            </span>
            <span class="plant-date">
                Registered: {{ plant['created_at'].strftime('%b %d, %Y') }}
            </span>

            <div class="plant-card-actions">

                <form action="{{ url_for('water_plant', plant_id=plant['_id']) }}" method="POST" style="flex: 1;">
                    <button type="submit" class="btn-action btn-water">Water</button>
                </form>

                <a href="{{ url_for('edit_plant', plant_id=plant['_id']) }}" class="btn-action btn-edit">Edit</a>

                <form action="{{ url_for('delete_plant', plant_id=plant['_id']) }}" method="POST" style="flex: 1;"
                    onsubmit="return confirm('Are you sure you want to delete this plant?');">
                    <button type="submit" class="btn-action btn-delete">Delete</button>
                </form>

            </div>
        </div>

    </div>
    {% endfor %}
</div>
{% else %}
<div class="no-plants-message">
    You have no plants registered yet. Add one!
</div>
{% endif %}

{% endblock %}